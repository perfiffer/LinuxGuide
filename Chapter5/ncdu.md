ncdu，是基于ncurses的du升级版，用来在没有图形界面的情况下，可以远程在终端查看磁盘使用情况。  

## 0x01 安装
### 源码安装
可以到ncdu的[官网](https://dev.yorhel.nl/ncdu)下载源码
```
wget https://dev.yorhel.nl/download/ncdu-1.15.1.tar.gz 
tar -zxvf ncdu-1.15.1.tar.gz
cd ncdu-1.15.1
./configure --prefix=/data/ncdu #默认安装目录为/usr/local
make && make install
```

### yum安装
```
yum -y install ncdu
PS:此方式不适用于非yum包管理的发行版，如debain和ubuntu，应该使用apt-get获取安装。  
另外，并不是所有的发行版都包含ncdu安装包，可以先查询仓库中是否有，yum search ncdu，如果没有，可使用源码安装。
```

## 0x02 参数详解
```
# 模式选项
-h, --help 查看帮助信息
-v, -V, --version 打印版本信息
-f FILE 加载之前使用“-o”选项创建的文件，如果给定的文件是“-”，则从标准输入中读取
-o FILE 导出必要的信息到文件，而不是打开浏览器界面。如果文件是“-”，则会写入到标准输出。
-e 开启扩展模式，除了通用的文件信息之外，还将读取每个文件的所属者、权限和最后修改时间。此操作会加大内存的使用量（约30%），导出的文件也会更大。

# 接口选项
-0 在扫描目录和导入文件时不会给出任何的反馈信息，除非发生致命错误。ncurses在扫描完成之前不会被初始化。当使用“-o”选项导出文件时，ncurses不会被初始化。此选项是导出到标准输出时的默认选项。
-1 类似于“-0”，但是会输出一行用来反馈扫描的进度。此选项是导出到文件时的默认选项。
-2 在扫描或导入文件时提供全屏的ncurses界面。这是在扫描时提供任何非致命错误反馈的唯一选项。
-q 静默模式。当扫描或导入目录时，ncdu将默认每秒更新10次屏幕，在静默模式下，将减少到每2秒更新一次。使用此功能可以在远程连接时节省带宽。当使用“-0”选项时，此选项不起作用。
-r 只读模式。此选项会禁用内置的文件删除功能。当使用“-o”选项时，此选项不起作用，因为在这种情况下，没有浏览器界面。当使用“-f”选项时，此选项也不起作用，因为删除功能在这种情况下是禁用的。
-rr 除了“-r”选项之外，此选项也会禁用shell的浏览器功能。
--si 使用基数10前缀的列表大小，即国际单位制（SI）中定义的1000（KB、MB等）的幂，而不是通常的基数2的前缀，即1024（KiB，MiB等）的幂。
--confirm-quit 在退出ncdu时，给出确认提示信息，在长时间的扫描时按“q”键退出时，此选项十分有用。
--color SCHEME 选择一个配色方案，目前只有2种配色方案：off-禁用颜色（默认），dark-用于暗背景的颜色方案。

# 扫描选项
-x 不跨越文件系统边界，只计算与被扫描目录相同文件系统上的文件和目录。
--exclude PATTERN 排除匹配模式的文件。默认情况下，这些文件仍然显示，但不计入磁盘使用统计数据。可以多次添加此参数以添加更多的模式。
-X FILE, --exclude-from FILE 排除与文件中任何模式匹配的文件。模式之间应该用换行符分隔。
--exclude-caches 排除包含CACHEDIR.TAG的目录。目录仍然会显示出来，但不会显示内容，而且不会被计入磁盘使用统计数据中。详细信息查看[http://www.brynosaurus.com/cachedir/](http://www.brynosaurus.com/cachedir/)
-L, --follow-symlinks 跟踪符号链接并计算它们指向的文件大小。在ncdu 1.14版本中，此选项将不遵循符号链接到目录，并将每个符号链接文件视为唯一的文件（即不像硬链接的处理方式）。在以后的版本中可能会有所改变。
--exclude-firmlinks （只适用于MacOS）排除固件链接。
--exclude-kernfs （仅适用于Linux系统）排除Linux伪文件系统，例如/proc（procfs）、/sys（sysfs），当前已知的伪文件系统有：binfmt、bpf、cgroup、cgroup2、debug、devpts、proc、pstore、security、selinux、sys、trace

# 快捷键
? 显示帮助信息。
up, down j, k 上下移动光标。
right, enter, l 打开所选目录。
left, <, h 返回上层目录。
n 按照文件名排序（再按一次倒序排列）。
s 按照文件大小排序（再按一次倒序排列）。
C 按照项目数排列（再按一次倒序排列）。
a 切换展示磁盘使用情况和磁盘大小。
M 根据最新的文件的修改时间排序（再按一次倒序排列），需要配合“-e”选项。
d 删除选定的文件或目录。当目录的内容不匹配或文件系统上不存在时，将显示一条错误信息。
t 排序时将目录放在文件前面。
g 在显示百分比、图形、两者或都不显示之间切换。百分比是相对于当前目录的大小，图是相对于当前目录中的最大的项。
c 切换显示子项目的计数。
m 切换展示最新的修改时间，需要配合“-e”选项。
e 显示或隐藏“隐藏的”或“排除的”文件和目录。请注意，即使您看不到隐藏的文件和目录，它们仍然在那里，它们仍然包含在目录大小中。如果您怀疑屏幕底部显示的总数不正确，请确认您没有开启此选项。
i 显示选中项的详细信息。
r 刷新/重新计算当前的目录。
b 在当前目录下打开shell。
q 退出ncdu。

# 文件标记
! 读取目录失败。
. 读取子目录时发生错误，因此指示的大小可能不正确。
< 使用排除模式将文件或目录从统计数据中排除的文件。
> 目录位于另一个文件系统上。
^ 目录被排除在统计数据之外，因为它是一个Linux伪文件系统。
@ 既不是一个文件也不是一个文件夹（是符号链接或者套接字）。
H 相同的文件已经被计数（硬链接）。
e 空目录。
```

## 0x03 使用示例
```
$ ncdu
# 后面如果不指定路径，默认扫描当前目录
# 扫描路径/home的磁盘使用情况
$ ncdu /home

```
